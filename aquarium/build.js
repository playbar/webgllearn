(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
!function(e,t,n){function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function o(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return k[e.which]?k[e.which]:v[e.which]?v[e.which]:String.fromCharCode(e.which).toLowerCase()}function a(e,t){return e.sort().join(",")===t.sort().join(",")}function i(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function c(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function u(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function l(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function s(){if(!m){m={};for(var e in k)e>95&&e<112||k.hasOwnProperty(e)&&(m[k[e]]=e)}return m}function f(e,t,n){return n||(n=s()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function p(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}function d(e,t){var n,r,o,a=[];for(n=p(e),o=0;o<n.length;++o)r=n[o],g[r]&&(r=g[r]),t&&"keypress"!=t&&b[r]&&(r=b[r],a.push("shift")),l(r)&&a.push(r);return t=f(r,a,t),{key:r,modifiers:a,action:t}}function h(e,n){return null!==e&&e!==t&&(e===n||h(e.parentNode,n))}function y(e){function n(e){e=e||{};var t,n=!1;for(t in g)e[t]?n=!0:g[t]=0;n||(K=!1)}function s(e,t,n,r,o,i){var c,u,s=[],f=n.type;if(!v._callbacks[e])return[];for("keyup"==f&&l(e)&&(t=[e]),c=0;c<v._callbacks[e].length;++c)if(u=v._callbacks[e][c],(r||!u.seq||g[u.seq]==u.level)&&f==u.action&&("keypress"==f&&!n.metaKey&&!n.ctrlKey||a(t,u.modifiers))){var p=!r&&u.combo==o,d=r&&u.seq==r&&u.level==i;(p||d)&&v._callbacks[e].splice(c,1),s.push(u)}return s}function f(e,t,n,r){v.stopCallback(t,t.target||t.srcElement,n,r)||!1===e(t,n)&&(c(t),u(t))}function p(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=o(e);t&&("keyup"!=e.type||w!==t?v.handleKey(t,i(e),e):w=!1)}function h(){clearTimeout(b),b=setTimeout(n,1e3)}function m(e,t,r,a){g[e]=0;for(var i=0;i<t.length;++i){var c=i+1===t.length?function(t){f(r,t,e),"keyup"!==a&&(w=o(t)),setTimeout(n,10)}:function(t){return function(){K=t,++g[e],h()}}(a||d(t[i+1]).action);k(t[i],c,a,e,i)}}function k(e,t,n,r,o){v._directMap[e+":"+n]=t;var a,i=(e=e.replace(/\s+/g," ")).split(" ");i.length>1?m(e,i,t,n):(a=d(e,n),v._callbacks[a.key]=v._callbacks[a.key]||[],s(a.key,a.modifiers,{type:a.action},r,e,o),v._callbacks[a.key][r?"unshift":"push"]({callback:t,modifiers:a.modifiers,action:a.action,seq:r,level:o,combo:e}))}var v=this;if(e=e||t,!(v instanceof y))return new y(e);v.target=e,v._callbacks={},v._directMap={};var b,g={},w=!1,_=!1,K=!1;v._handleKey=function(e,t,r){var o,a=s(e,t,r),i={},c=0,u=!1;for(o=0;o<a.length;++o)a[o].seq&&(c=Math.max(c,a[o].level));for(o=0;o<a.length;++o)if(a[o].seq){if(a[o].level!=c)continue;u=!0,i[a[o].seq]=1,f(a[o].callback,r,a[o].combo,a[o].seq)}else u||f(a[o].callback,r,a[o].combo);var p="keypress"==r.type&&_;r.type!=K||l(e)||p||n(i),_=u&&"keydown"==r.type},v._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)k(e[r],t,n)},r(e,"keypress",p),r(e,"keydown",p),r(e,"keyup",p)}if(e){for(var m,k={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},v={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},b={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},g={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},w=1;w<20;++w)k[111+w]="f"+w;for(w=0;w<=9;++w)k[w+96]=w.toString();y.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},y.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},y.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,t){var n=this;return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!h(t,n.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(k[t]=e[t]);m=null},y.init=function(){var e=y(t);for(var n in e)"_"!==n.charAt(0)&&(y[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n))},y.init(),e.Mousetrap=y,"undefined"!=typeof module&&module.exports&&(module.exports=y),"function"==typeof define&&define.amd&&define(function(){return y})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null);

},{}],2:[function(require,module,exports){
"use strict";function toRad(e){return e*Math.PI/180}function timeNow(){return(new Date).getTime()/1e3}function fishFront(){var e=fishes[currentViewFish],i=e.lookx-e.x,o=e.looky-e.y,t=e.lookz-e.z,s=Math.sqrt(i*i+o*o+t*t);e.x+=.05*i/s,e.y+=.05*o/s,e.z+=.05*t/s,e.lookx+=.05*i/s,e.looky+=.05*o/s,e.lookz+=.05*t/s}function fishLeft(){var e=fishes[currentViewFish],i=(e.x-e.lookx)*(e.x-e.lookx)+(e.z-e.lookz)*(e.z-e.lookz);i=Math.sqrt(i);var o=Math.atan2(e.z-e.lookz,e.x-e.lookx);o-=.02,e.lookx=e.x+i*Math.cos(o),e.lookz=e.z+i*Math.sin(o)}function fishRight(){var e=fishes[currentViewFish],i=(e.x-e.lookx)*(e.x-e.lookx)+(e.z-e.lookz)*(e.z-e.lookz);i=Math.sqrt(i);var o=Math.atan2(e.z-e.lookz,e.x-e.lookx);o+=.02,e.lookx=e.x+i*Math.cos(o),e.lookz=e.z+i*Math.sin(o)}function Fish(e,i,o,t,s,r,a,n,l,h,u,c,m){return{x:e,y:i,z:o,lookx:t,looky:s,lookz:r,alive:a,type:n,id:l,scale:h,lastTurnTime:u,triggerReverse:c,angley:m}}function cycleFish(){return fishViewOn=!0,[fishes[currentViewFish].x,fishes[currentViewFish].y,fishes[currentViewFish].z].concat([fishes[currentViewFish].lookx,fishes[currentViewFish].looky,fishes[currentViewFish].lookz])}function cancelFishView(){currentViewFish=0,fishViewOn=!1}function initFish(){var e=Fish(0,0,0,1,1,1,!0,1,1,[.7,.7,.7],timeNow(),0,0),i=Fish(3,3,3,-1,-1,-1,!0,2,2,[.7,.7,.7],timeNow(),0,0),o=Fish(-2,-2,-2,1,0,0,!0,3,3,[.7,.7,.7],timeNow(),0,0),t=Fish(-1,2,-2,0,0,1,!0,4,4,[.7,.7,.7],timeNow(),0,0);(fishes=[e,i,o,t]).map(function(e){makeModel("fish"+e.type.toString(),"assets/fish"+e.type,[e.x,e.y,e.z],e.scale)}),makeModel("egg","assets/food",[0,0,0],[.3,.3,.3])}function fishMoveTowardsFood(e,i,o){fishes.map(function(t){t.lookx=e,t.looky=i,t.lookz=o})}function drawFish(){fishes.map(function(e,i){if(!fishViewOn||fishViewOn&&i!=currentViewFish){var o=models["fish"+e.type.toString()],t=models.egg;Matrices.model=m.scale(e.scale),Matrices.model=m.multiply(m.rotateY(e.angley*Math.PI/180),Matrices.model),Matrices.model=m.multiply(m.inverse(m.lookAt([e.x,e.y,e.z],[-e.lookx,-e.looky,-e.lookz],[0,1,0])),Matrices.model),drawModel(o)}eggData.active&&(Matrices.model=m.multiply(m.translate(t.center),m.scale(t.scale)),drawModel(t))})}function updateFish(){fishes.map(function(e){if(e.angley.toFixed(1)<=10&&1==e.triggerReverse&&(e.angley+=1,e.angley+=Math.random()/2,e.angley.toFixed(1)>=10&&(e.angley=10,e.triggerReverse=0)),e.angley.toFixed(1)>=-10&&0==e.triggerReverse&&(e.angley-=1,e.angley-=Math.random()/2,e.angley.toFixed(1)<=-10&&(e.angley=-10,e.triggerReverse=1)),(e.x>=aquariumSize.x-1.2||e.x<=1.2-aquariumSize.x)&&(e.lookx=-1*e.lookx),(e.y>=aquariumSize.y-1.2||e.y<=1.2-aquariumSize.y)&&(e.looky=-1*e.looky),(e.z>=aquariumSize.z-1.2||e.z<=1.2-aquariumSize.z)&&(e.lookz=-1*e.lookz),timeNow()-e.lastTurnTime<=turnTime){var i=e.lookx-e.x,o=e.looky-e.y,t=e.lookz-e.z,s=Math.sqrt(i*i+o*o+t*t);e.x+=.07*i/s,e.y+=.07*o/s,e.z+=.07*t/s,e.lookx+=.07*i/s,e.looky+=.07*o/s,e.lookz+=.07*t/s}else e.lookx=e.x+3*(Math.random()-.5),e.looky=e.y+3*(Math.random()-.5),e.lookz=e.z+3*(Math.random()-.5),e.lastTurnTime=timeNow();e.scale[0]<.7&&(e.scale[0]=e.scale[1]=e.scale[2]=e.scale[0]+.001)})}function updateEgg(){if(eggData.active)if(models.egg.center[1]>=1-aquariumSize.y)models.egg.center[1]-=.2;else if((new Date).getTime()/1e3-eggData.startTime<=eggData.timeBeforeShrink)for(var e=0;e<=2;e++)models.egg.scale[e]-=.008;else{for(var i=0;i<=2;i++)models.egg.scale[i]=1;eggData.active=!1;var o=Fish(models.egg.center[0],models.egg.center[1]-1,models.egg.center[2],-1,-1,-1,!0,2,2,[.1,.1,.1],timeNow(),0,0);fishes.push(o)}else models.egg.center[1]=aquariumSize.y-1}var m=require("./matrix"),mousetrap=require("mousetrap"),_require=require("./models"),makeModel=_require.makeModel,drawModel=_require.drawModel,aquariumSize={x:8,y:7*.7,z:8},aquariumSizeOri={x:10,y:7,z:10},fishes=[],turnTime=10,currentViewFish=0,fishViewOn=!1;mousetrap.bind("left",function(){return currentViewFish=(fishes.length+currentViewFish+1)%fishes.length}),mousetrap.bind("right",function(){return currentViewFish=(fishes.length+currentViewFish-1)%fishes.length}),mousetrap.bind("k",function(){fishes.splice(currentViewFish||0,1),currentViewFish=(currentViewFish+1)%fishes.length});var eggData={timeBeforeShrink:3,startTime:0,active:!1};mousetrap.bind("e",function(){eggData.active||(models.egg.center[0]=fishes[currentViewFish||0].x,models.egg.center[1]=fishes[currentViewFish||0].y,models.egg.center[2]=fishes[currentViewFish||0].z,eggData.active=!0,eggData.startTime=(new Date).getTime()/1e3)}),module.exports={initFish:initFish,drawFish:drawFish,updateFish:updateFish,cycleFish:cycleFish,cancelFishView:cancelFishView,fishMoveTowardsFood:fishMoveTowardsFood,aquariumSize:aquariumSizeOri,updateEgg:updateEgg,fishFront:fishFront,fishLeft:fishLeft,fishRight:fishRight};

},{"./matrix":4,"./models":5,"mousetrap":1}],3:[function(require,module,exports){
"use strict";function updateCameraTarget(e){if(Camera.mouseUpdate&&!Camera.fishView){var a=window.canvas.getBoundingClientRect();e&&(Camera.mouseX=e.clientX,Camera.mouseY=e.clientY);var i=Camera.mouseX-a.left,r=Camera.mouseY-a.top;i-=window.canvas.width/2,r=window.canvas.height/2-r;var o=-180/window.canvas.height*r+90,t=360/window.canvas.width*i+180,m=1*Math.sin(toRadians(o))*Math.cos(toRadians(t)),s=1*Math.cos(toRadians(o)),l=1*Math.sin(toRadians(o))*Math.sin(toRadians(t));Camera.lookx=Camera.x+m,Camera.looky=Camera.y+s,Camera.lookz=Camera.z+l}}function toRadians(e){return e*(Math.PI/180)}function resizeCanvas(){canvas.height=canvas.width=Math.min($(document).height(),$(document).width())}function Initialize(){document.getElementById("backaudio").play(),window.canvas=document.getElementById("canvas"),resizeCanvas(),window.addEventListener("resize",resizeCanvas),window.canvas.oncontextmenu=function(){bubbles.num++,bubbles.activeBubbles.push(bubbles.num);var e=Math.floor(Math.random()*(2*aquariumSize.x+1)-aquariumSize.x),a=Math.floor(Math.random()*(2*aquariumSize.z+1)-aquariumSize.z);return makeModel("bubble"+bubbles.num.toString(),"assets/bubble",[e,2-aquariumSize.y,a],[.3,.3,.3]),!1},window.canvas.onmousemove=updateCameraTarget,window.canvas.onclick=function(){foodData.active||(models.food.center[0]=Math.floor(Math.random()*(2*aquariumSize.x+1-1.6)-aquariumSize.x),models.food.center[2]=Math.floor(Math.random()*(2*aquariumSize.z+1-1.6)-aquariumSize.z),foodData.active=!0,foodData.startTime=(new Date).getTime()/1e3,fishMovingTowardsFood=!0,fishMoveTowardsFood())},window.gl=canvas.getContext("experimental-webgl"),gl.clearColor(0,0,0,1),shaders.createShader("material");for(var e=0;e<pebblesN;e++)makeModel("pebble"+e,"assets/pebble",[.9*-aquariumSize.x+1.8*aquariumSize.x*Math.random(),.1-aquariumSize.y,.9*-aquariumSize.z+1.8*aquariumSize.z*Math.random()],[.4,.4,.4]);makeModel("rock","assets/rock",[6,1-aquariumSize.y,6],[.4,.4,.4]),makeModel("wall","assets/wall",[0,0,0],[30,30,30]),makeModel("light","assets/cube",[28,25,0],[1,1,4]),makeModel("fish","assets/fish",[0,0,0]),makeModel("xaxis","assets/cube",[1,0,0],[1,.1,.1]),makeModel("yaxis","assets/cube",[0,1,0],[.1,1,.1]),makeModel("aquarium","assets/aquarium",[0,0,0],[aquariumSize.x,aquariumSize.y,aquariumSize.z]),makeModel("sand","assets/sand",[0,-aquariumSize.y-1,0],[aquariumSize.x,-1,aquariumSize.z]),makeModel("metal","assets/metal",[0,aquariumSize.y+.2,0],[aquariumSize.x,.2,aquariumSize.z]),makeModel("table","assets/table",[0,-(26-aquariumSize.y),0],[1.5*aquariumSize.x,28-aquariumSize.y,2.5*aquariumSize.z]),makeModel("weed","assets/weed",[3.2-aquariumSize.x,-aquariumSize.y,1],[.04,.04,.04]),makeModel("ship","assets/ship",[1.5,.3-aquariumSize.y,.7*-aquariumSize.z],[2,2,2]),makeModel("food","assets/food",[0,0,0],[1,1,1]),makeModel("cubetex","assets/cubetex",[15,10,5]),initFish(),tick()}function animate(){var e=(new Date).getTime();0!=lastTime?(updateFishView(),updateCamera(),updateBubbles(),tickWeed(),updateFood(),updateFish(),updateEgg(),lastTime=e):lastTime=e}function updateFishView(){if(Camera.fishView){var e=cycleFish();Camera.x=e[0],Camera.y=e[1],Camera.z=e[2],Camera.lookx=e[3],Camera.looky=e[4],Camera.lookz=e[5]}}function updateBubbles(){bubbles.activeBubbles.map(function(e,a){var i=models["bubble"+e.toString()];i.center[1]<=aquariumSize.y-.8?i.center[1]+=.2:bubbles.activeBubbles.splice(a,1)})}function updateFood(){if(foodData.active)if(fishMovingTowardsFood&&fishMoveTowardsFood(models.food.center[0],models.food.center[1],models.food.center[2]),models.food.center[1]>=1-aquariumSize.y)models.food.center[1]-=.2;else if((new Date).getTime()/1e3-foodData.startTime<=foodData.timeBeforeShrink)for(var e=0;e<=2;e++)models.food.scale[e]-=.008;else{for(var a=0;a<=2;a++)models.food.scale[a]=1;fishMovingTowardsFood=!1,foodData.active=!1}else models.food.center[1]=aquariumSize.y-1}function tickWeed(){var e=models.weed;e.anglex<=10&&1==movepositivex&&(e.anglex+=.2,e.anglex>10&&(movepositivex=0)),e.anglex>=-10&&0==movepositivex&&(e.anglex-=.2,e.anglex<-10&&(movepositivex=1))}function drawScene(){var e=models,a=e.aquarium,i=e.sand,r=e.metal,o=e.ship,t=models,s=t.weed,l=t.wall,n=t.light,u=t.rock,d=t.food,c=t.table;weedStart||(s.anglex=0,s.angley=0,s.anglez=0,weedStart=1),gl.viewport(0,0,canvas.width,canvas.height),gl.clearColor(.1,.1,.1,1),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),shaders.useShader("material"),gl.enable(gl.DEPTH_TEST),gl.depthFunc(gl.LEQUAL),Matrices.model=m.scale(s.scale),Matrices.model=m.multiply(Matrices.model,m.rotateX(s.anglex*Math.PI/180)),Matrices.model=m.multiply(m.translate(s.center),Matrices.model),drawModel(s),Matrices.model=m.multiply(m.translate(u.center),m.scale(u.scale)),drawModel(u),Matrices.model=m.multiply(m.translate(i.center),m.scale(i.scale)),drawModel(i),Matrices.model=m.multiply(m.translate(r.center),m.scale(r.scale)),drawModel(r);for(var f=0;f<pebblesN;f++){var h=models["pebble"+f];Matrices.model=m.multiply(m.translate(h.center),m.scale(h.scale)),drawModel(h)}bubbles.activeBubbles.map(function(e){var a=models["bubble"+e.toString()];Matrices.model=m.multiply(m.translate(a.center),m.scale(a.scale)),drawModel(a)}),Matrices.model=m.multiply(m.translate(l.center),m.scale(l.scale)),drawModel(l),Matrices.model=m.rotateZ(15*Math.PI/180),Matrices.model=m.multiply(m.scale(o.scale),Matrices.model),Matrices.model=m.multiply(m.translate(o.center),Matrices.model),drawModel(o),Matrices.model=m.multiply(m.translate(c.center),m.scale(c.scale)),drawModel(c),Matrices.model=m.multiply(m.translate(n.center),m.scale(n.scale)),drawLight(n),foodData.active&&(Matrices.model=m.multiply(m.translate(d.center),m.scale(d.scale)),drawModel(d)),drawFish(),gl.enable(gl.BLEND),gl.blendFunc(gl.ONE,gl.ONE),(Camera.x>aquariumSize.x||Camera.x<-aquariumSize.x||Camera.y>aquariumSize.y||Camera.y<-aquariumSize.y||Camera.z>aquariumSize.z||Camera.z<-aquariumSize.z)&&gl.enable(gl.CULL_FACE),Matrices.model=m.multiply(m.translate(a.center),m.scale(a.scale)),drawModel(a),gl.disable(gl.CULL_FACE),gl.disable(gl.BLEND)}function updateCamera(){var e=[0,1,0],a=[Camera.x,Camera.y,Camera.z],i=[Camera.lookx,Camera.looky,Camera.lookz];Matrices.view=m.lookAt(a,i,e),Matrices.projection=m.perspective(Math.PI/2,canvas.width/canvas.height,.1,500),gl.uniformMatrix4fv(gl.getUniformLocation(program,"view"),!1,Matrices.view),gl.uniformMatrix4fv(gl.getUniformLocation(program,"projection"),!1,Matrices.projection),gl.uniform1i(gl.getUniformLocation(program,"isFishLens"),Camera.fishLens&&Camera.fishView);var r=models.light.center,o=gl.getUniformLocation(program,"light.position"),t=gl.getUniformLocation(program,"viewPos");gl.uniform3f(o,r[0],r[1],r[2]),gl.uniform3f(t,a[0],a[1],a[2]);var s=[];s[0]=1,s[1]=1,s[2]=1;var l=vec.multiplyScalar(s,.5),n=vec.multiplyScalar(l,1);gl.uniform3f(gl.getUniformLocation(program,"light.ambient"),n[0],n[1],n[2]),gl.uniform3f(gl.getUniformLocation(program,"light.diffuse"),l[0],l[1],l[2]),gl.uniform3f(gl.getUniformLocation(program,"light.specular"),1,1,1)}function tick(){window.requestAnimationFrame(tick),window.program&&(drawScene(),animate())}var shaders=require("./shaders"),_require=require("./models"),drawModel=_require.drawModel,makeModel=_require.makeModel,drawLight=_require.drawLight,m=require("./matrix"),vec=require("./vector"),weedStart=0,movepositivex=1,pebblesN=15,_require2=require("./fish"),initFish=_require2.initFish,drawFish=_require2.drawFish,updateFish=_require2.updateFish,cycleFish=_require2.cycleFish,cancelFishView=_require2.cancelFishView,fishMoveTowardsFood=_require2.fishMoveTowardsFood,aquariumSize=_require2.aquariumSize,updateEgg=_require2.updateEgg,fishFront=_require2.fishFront,fishLeft=_require2.fishLeft,fishRight=_require2.fishRight,fishMovingTowardsFood=!1,mousetrap=require("mousetrap");mousetrap.bind("c",function(){Camera.fishView||(Camera.mouseUpdate=!Camera.mouseUpdate)}),mousetrap.bind("f",function(){Camera.fishView?(cancelFishView(),Camera.fishView=!1):Camera.fishView=!0}),mousetrap.bind("v",function(){Camera.fishLens=!Camera.fishLens}),mousetrap.bind("s",function(){if(!Camera.fishView){var e=Camera.lookx-Camera.x,a=Camera.looky-Camera.y,i=Camera.lookz-Camera.z,r=Math.sqrt(e*e+a*a+i*i);Camera.x-=.8*e/r,Camera.y-=.8*a/r,Camera.z-=.8*i/r,updateCameraTarget()}}),mousetrap.bind("w",function(){if(Camera.fishView)fishFront();else{var e=Camera.lookx-Camera.x,a=Camera.looky-Camera.y,i=Camera.lookz-Camera.z,r=Math.sqrt(e*e+a*a+i*i);Camera.x+=.8*e/r,Camera.y+=.8*a/r,Camera.z+=.8*i/r,updateCameraTarget()}}),mousetrap.bind("a",function(){Camera.fishView&&fishLeft()}),mousetrap.bind("d",function(){Camera.fishView&&fishRight()});var bubbles={activeBubbles:[],num:0},foodData={timeBeforeShrink:3,startTime:0,active:!1},Camera={x:19,y:9,z:12,lookx:0,looky:0,lookz:0,mouseUpdate:!0,fishLens:!1,fishView:!1,mouseX:0,mouseY:0};window.Matrices={},window.models={},window.Initialize=Initialize,window.Camera=Camera;var lastTime=0;

},{"./fish":2,"./matrix":4,"./models":5,"./shaders":6,"./vector":7,"mousetrap":1}],4:[function(require,module,exports){
"use strict";function matrixMultiply(t,e){return[e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15]]}function matrixMultiply4x1(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*t[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*t[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*t[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*t[3]]}function multiply(t,e){return 4==e.length?matrixMultiply4x1(t,e):matrixMultiply(t,e)}function inverse(t){var e=t[0]*t[5]-t[4]*t[1],r=t[0]*t[6]-t[4]*t[2],n=t[0]*t[7]-t[4]*t[3],a=t[1]*t[6]-t[5]*t[2],i=t[1]*t[7]-t[5]*t[3],o=t[2]*t[7]-t[6]*t[3],u=t[10]*t[15]-t[14]*t[11],c=t[9]*t[15]-t[13]*t[11],l=t[9]*t[14]-t[13]*t[10],s=t[8]*t[15]-t[12]*t[11],v=t[8]*t[14]-t[12]*t[10],f=t[8]*t[13]-t[12]*t[9],p=1/(e*u-r*c+n*l+a*s-i*v+o*f),m=[[],[],[],[]];return m[0]=(t[5]*u-t[6]*c+t[7]*l)*p,m[1]=(-t[1]*u+t[2]*c-t[3]*l)*p,m[2]=(t[13]*o-t[14]*i+t[15]*a)*p,m[3]=(-t[9]*o+t[10]*i-t[11]*a)*p,m[4]=(-t[4]*u+t[6]*s-t[7]*v)*p,m[5]=(t[0]*u-t[2]*s+t[3]*v)*p,m[6]=(-t[12]*o+t[14]*n-t[15]*r)*p,m[7]=(t[8]*o-t[10]*n+t[11]*r)*p,m[8]=(t[4]*c-t[5]*s+t[7]*f)*p,m[9]=(-t[0]*c+t[1]*s-t[3]*f)*p,m[10]=(t[12]*i-t[13]*n+t[15]*e)*p,m[11]=(-t[8]*i+t[9]*n-t[11]*e)*p,m[12]=(-t[4]*l+t[5]*v-t[6]*f)*p,m[13]=(t[0]*l-t[1]*v+t[2]*f)*p,m[14]=(-t[12]*a+t[13]*r-t[14]*e)*p,m[15]=(t[8]*a-t[9]*r+t[10]*e)*p,m}function perspective(t,e,r,n){var a=Math.tan(.5*Math.PI-.5*t),i=1/(r-n);return[a/e,0,0,0,0,a,0,0,0,0,(r+n)*i,-1,0,0,r*n*i*2,0]}function makeZToWMatrix(t){return[1,0,0,0,0,1,0,0,0,0,1,t,0,0,0,1]}function translate(t,e,r){if("number"!=typeof t){var n=t;t=n[0],e=n[1],r=n[2]}return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1]}function rotateX(t){var e=Math.cos(t),r=Math.sin(t);return[1,0,0,0,0,e,r,0,0,-r,e,0,0,0,0,1]}function rotateY(t){var e=Math.cos(t),r=Math.sin(t);return[e,0,-r,0,0,1,0,0,r,0,e,0,0,0,0,1]}function rotateZ(t){var e=Math.cos(t),r=Math.sin(t);return[e,r,0,0,-r,e,0,0,0,0,1,0,0,0,0,1]}function scale(t,e,r){if("number"!=typeof t){var n=t;t=n[0],e=n[1],r=n[2]}return[t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1]}function lookAt(t,e,r){var n=vec.normalize(vec.subtract(e,t)),a=vec.normalize(vec.cross(n,r)),i=vec.cross(a,n),o=identity();return o[0]=a[0],o[4]=a[1],o[8]=a[2],o[1]=i[0],o[5]=i[1],o[9]=i[2],o[2]=-n[0],o[6]=-n[1],o[10]=-n[2],o[12]=-vec.dot(a,t),o[13]=-vec.dot(i,t),o[14]=vec.dot(n,t),o}function identity(){return scale(1,1,1)}var vec=require("./vector");module.exports={multiply:multiply,inverse:inverse,identity:identity,perspective:perspective,makeZToWMatrix:makeZToWMatrix,lookAt:lookAt,translate:translate,rotateX:rotateX,rotateY:rotateY,rotateZ:rotateZ,scale:scale};

},{"./vector":7}],5:[function(require,module,exports){
"use strict";function openFile(e,r){var a;$.ajax({url:r+".obj",dataType:"text",success:function(t){a=t,$.ajax({url:r+".mtl",dataType:"text",success:function(r){createModel(e,a,r)}})}})}function makeModel(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1];models[e]={name:e,center:a,scale:t},openFile(e,r)}function parseMtl(e){for(var r={},a=e.split("\n"),t="",l=0;l<a.length;l++){var i=a[l].split(" ");"newmtl"==i[0]?r[t=i[1]]={}:"Kd"==i[0]?r[t].diffuse=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])]:"Ks"==i[0]?r[t].specular=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])]:"Ka"==i[0]?r[t].ambient=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])]:"Ns"==i[0]?r[t].shininess=parseFloat(i[1]):"map_Kd"==i[0]&&loadTexture(i[1],r[t])}return r}function handleLoadedTexture(e){gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),gl.bindTexture(gl.TEXTURE_2D,e),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,e.image),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR_MIPMAP_NEAREST),gl.generateMipmap(gl.TEXTURE_2D),gl.bindTexture(gl.TEXTURE_2D,null)}function loadTexture(e,r){var a=gl.createTexture();return a.image=new Image,a.image.onload=function(){handleLoadedTexture(a),r.texture=a},a.image.src=e,a}function createModel(e,r,a){var t=models[e],l=parseMtl(a),i=[],o=[],n=1e6,g=-1e6,s=1e6,u=-1e6,f=1e6,m=-1e6,p=!1,d=[],x=[],A=[],R=[];t.vaos=[];var T=r.split("\n");(T=T.map(function(e){return e.trim()})).push("usemtl");for(var F=0;F<T.length;F++){var c=T[F].split(" ");if("v"==c[0]){var v={};v.x=parseFloat(c[1]),v.x>g&&(g=v.x),v.x<n&&(n=v.x),v.y=parseFloat(c[2]),v.y>u&&(u=v.y),v.y<s&&(s=v.y),v.z=parseFloat(c[3]),v.z>m&&(m=v.z),v.z<f&&(f=v.z),o.push(v)}else if("vn"==c[0]){var E={};E.x=parseFloat(c[1]),E.y=parseFloat(c[2]),E.z=parseFloat(c[3]),d.push(E)}else if("vt"==c[0]){var h={};h.s=parseFloat(c[1]),h.t=parseFloat(c[2]),A.push(h)}}t.minX=n,t.maxX=g,t.minY=s,t.maxY=u,t.minZ=f,t.maxZ=m;for(var U="",_=0;_<T.length;_++){var B=T[_].split(" ");if("f"==B[0])for(var L=1;L<4;L++){var b=B[L].split("/"),M=parseInt(b[0])-1,I=parseInt(b[1])-1,D=parseInt(b[2])-1;i.push(o[M].x),i.push(o[M].y),i.push(o[M].z),isNaN(I)||(R.push(A[I].s),R.push(A[I].t)),p?(x.push(-d[D].x),x.push(-d[D].y),x.push(-d[D].z)):(x.push(d[D].x),x.push(d[D].y),x.push(d[D].z))}else if("usemtl"==B[0]){var w={};if(w.numVertex=i.length/3,0!=w.numVertex){var y=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,y),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(i),gl.STATIC_DRAW),w.vertexBuffer=y;var Y=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,Y),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(x),gl.STATIC_DRAW),w.normalBuffer=Y;var N=gl.createBuffer();if(gl.bindBuffer(gl.ARRAY_BUFFER,N),R.length>0)gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(R),gl.STATIC_DRAW),w.isTextured=!0;else{for(var X=0;X<2*w.numVertex;X++)R.push(0);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(R),gl.STATIC_DRAW),w.isTextured=!1}w.textureBuffer=N,w.material=l[U],t.vaos.push(w),i=[],x=[],R=[]}else"invertNormals"==B[0]&&(p=!p);U=B[1]}}}function drawModel(e){e.vaos&&(gl.uniformMatrix4fv(gl.getUniformLocation(program,"model"),!1,Matrices.model),gl.uniformMatrix4fv(gl.getUniformLocation(program,"modelInv"),!1,m.inverse(Matrices.model)),e.vaos.map(drawVAO))}function drawLight(e){gl.uniform1i(gl.getUniformLocation(program,"isLight"),1),drawModel(e),gl.uniform1i(gl.getUniformLocation(program,"isLight"),0)}function drawVAO(e){if(e.vertexBuffer){loadMaterial(e.material),gl.bindBuffer(gl.ARRAY_BUFFER,e.vertexBuffer),gl.vertexAttribPointer(program.positionAttribute,3,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,e.normalBuffer),gl.vertexAttribPointer(program.normalAttribute,3,gl.FLOAT,!1,0,0);var r=e.material.texture&&e.isTextured;gl.uniform1i(gl.getUniformLocation(program,"isTextured"),r),gl.bindBuffer(gl.ARRAY_BUFFER,e.textureBuffer),gl.vertexAttribPointer(program.textureAttribute,2,gl.FLOAT,!1,0,0),r&&(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,e.material.texture),gl.uniform1i(gl.getUniformLocation(program,"sampler"),0)),gl.drawArrays(gl.TRIANGLES,0,e.numVertex)}}function loadMaterial(e){e||(e={ambient:[1,1,1],diffuse:[1,1,1],specular:[1,1,1],shininess:0}),gl.uniform3f(gl.getUniformLocation(program,"material.ambient"),e.ambient[0],e.ambient[1],e.ambient[2]),gl.uniform3f(gl.getUniformLocation(program,"material.diffuse"),e.diffuse[0],e.diffuse[1],e.diffuse[2]),gl.uniform3f(gl.getUniformLocation(program,"material.specular"),e.specular[0],e.specular[1],e.specular[2]),gl.uniform1f(gl.getUniformLocation(program,"material.shininess"),e.shininess)}var m=require("./matrix");module.exports={makeModel:makeModel,createModel:createModel,drawModel:drawModel,drawLight:drawLight};

},{"./matrix":4}],6:[function(require,module,exports){
"use strict";function compileShader(r,e,t){var a=r.createShader(t);if(r.shaderSource(a,e),r.compileShader(a),!r.getShaderParameter(a,r.COMPILE_STATUS))throw"could not compile shader:"+r.getShaderInfoLog(a);return a}function createProgram(r,e,t,a){var o=r.createProgram();if(r.attachShader(o,t),r.attachShader(o,a),r.linkProgram(o),r.deleteShader(t),r.deleteShader(a),!r.getProgramParameter(o,r.LINK_STATUS))throw"program filed to link:"+r.getProgramInfoLog(o);window.program=o,program.positionAttribute=r.getAttribLocation(program,"a_position"),r.enableVertexAttribArray(program.vertexAttribute),program.normalAttribute=r.getAttribLocation(program,"a_normal"),r.enableVertexAttribArray(program.normalAttribute),program.textureAttribute=r.getAttribLocation(program,"a_texture"),r.enableVertexAttribArray(program.textureAttribute),shaders[e]=o}function openFile(r,e){$.get(e+".vs",function(t){var a=compileShader(gl,t,gl.VERTEX_SHADER);$.get(e+".frag",function(e){console.log(t,e);var o=compileShader(gl,e,gl.FRAGMENT_SHADER);createProgram(gl,r,a,o)},"text")},"text")}function createShader(r){openFile(r,"shaders/"+r)}function useShader(r){window.program=shaders[r],gl.useProgram(window.program)}var shaders={};module.exports={compileShader:compileShader,createShader:createShader,useShader:useShader};

},{}],7:[function(require,module,exports){
"use strict";function dot(r,t){var a=_slicedToArray(r,3),n=a[0],e=a[1],o=a[2],i=_slicedToArray(t,3);return n*i[0]+e*i[1]+o*i[2]}function cross(r,t){var a=_slicedToArray(r,3),n=a[0],e=a[1],o=a[2],i=_slicedToArray(t,3),c=i[0],l=i[1],u=i[2];return[e*u-o*l,o*c-n*u,n*l-e*c]}function add(r,t){var a=_slicedToArray(r,3),n=a[0],e=a[1],o=a[2],i=_slicedToArray(t,3);return[n+i[0],e+i[1],o+i[2]]}function subtract(r,t){var a=_slicedToArray(r,3),n=a[0],e=a[1],o=a[2],i=_slicedToArray(t,3);return[n-i[0],e-i[1],o-i[2]]}function abs(r){var t=_slicedToArray(r,3),a=t[0],n=t[1],e=t[2];return Math.sqrt(a*a+n*n+e*e)}function normalize(r){var t=_slicedToArray(r,3),a=t[0],n=t[1],e=t[2],o=abs([a,n,e]);return[a/o,n/o,e/o]}function multiplyScalar(r,t){var a=_slicedToArray(r,3);return[a[0]*t,a[1]*t,a[2]*t]}var _slicedToArray=function(){function r(r,t){var a=[],n=!0,e=!1,o=void 0;try{for(var i,c=r[Symbol.iterator]();!(n=(i=c.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(r){e=!0,o=r}finally{try{!n&&c.return&&c.return()}finally{if(e)throw o}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();module.exports={dot:dot,cross:cross,add:add,subtract:subtract,abs:abs,normalize:normalize,multiplyScalar:multiplyScalar};

},{}]},{},[3]);
